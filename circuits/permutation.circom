pragma circom 2.0.3;

template Permutation() {
    signal input a0;
    signal input b0;
    signal input c0;
    
    signal input RC0;
    signal input RC1;
    signal input RC2;
    signal input RC3;

    signal output a1;
    signal output b1;
    signal output c1;

    signal a0_mul_b0_plus_c0_plus_b0;

    a0_mul_b0_plus_c0_plus_b0 <== a0*b0 + c0 + b0;
 
    a1 <== c0 + a0*b0 + RC2;
    b1 <== a0 + RC3*(a0_mul_b0_plus_c0_plus_b0) + RC0;
    c1 <== a0_mul_b0_plus_c0_plus_b0 + RC1;
}

template IteratedPermutationN() {
    signal input a0;
    signal input b0;
    signal input c0;
    
    signal output a1;
    signal output b1;
    signal output c1;
   
    var c[536] = [
            292334644102394411537362212093572878140,
            250282066453690133315708418387534650045,
            25210252274841859825108081164557115781,
            16246747660448753010909888379129524409,
            131669148524554050620166690622542333908,
            73395003443371763039182051680716568403,
            8260009929790711579150637832343448256,
            334561509980500295630109857265233755470,
            251572747396993099811617097119169178334,
            319551404291314842953250812519933899387,
            330640758715429519737303505376967190379,
            126057361753711913908703488930452556816,
            187899780603784731698151839689054581640,
            151057639745456246717215287663419796924,
            305609076732796609713444330396273784487,
            118448376296135774456375513776377201468,
            46454871715138680646845915938916802199,
            303637447071954698400920969187994679609,
            261293781192789842786771830734938690938,
            241691507804502561555688804203030780038,
            81929745328208047807564297881723656490,
            18198326379750965089917893649436623729,
            135868997836628286395541910575559147755,
            162651453722887278917702381886550269193,
            262871308786129854193859840200151476906,
            95849645594479220049429349396745744878,
            182852612228153313363054026504618598014,
            134544770119095787241864090128873870877,
            40541384435830279857438927956967931853,
            116513310841494518081479619488149410939,
            335658529325450061533605207278633204829,
            8856966265063174947869624775753304770,
            67172341740123816361927123146570128349,
            44482111308488328152107963475263739913,
            318818015539045234118066780480378419698,
            22109922917769998574560970444724415551,
            219533934777019508560371093053047011819,
            63796427300020888533622792187997329170,
            30085028647762965255196029328901776258,
            328552314159948043977345432484153790373,
            158217733191554104313546201402909503666,
            58146670617494901854016871848355784579,
            72838104975348767691430155472992232789,
            270256755022333391723662983264902114254,
            279432556993928842328288212179323509260,
            42498516548939541472411859202386669607,
            101770932702114991793479490435391053860,
            175728649992475958894655265138464837109,
            33204227079439574283247350727658105836,
            244539644225209453886555077234299660398,
            1310403725178485130097158507614814234,
            193482928194568493818837854786323536822,
            71100803467848427202770565852889735936,
            297461836292464924681748884118973606134,
            172488064579832119541060825118872930508,
            137953316723652647467286248883232015636,
            152921625387604874068191602776630654640,
            761592951778639687110021144905066369,
            213366124201344758141930971234857014456,
            21627440031347286729395951482213376700,
            208177731654530166777439946129867228536,
            169038580513031295989248684060597417385,
            176338801111316998533286255866276013259,
            75092999146096484406389206061691263845,
            316498167715264588075358124802239551448,
            26200644402925679136245596408177189364,
            107005702582340781795411656409052512254,
            335018274270043260757397087480193947914,
            207342776895569504287428531160138444860,
            217775666491901342561984748978147787653,
            263282949129650536422751461488307895499,
            274132011088045323247559411515746047383,
            163004054348401695600236132818346422129,
            11933906134099871770423587831424563302,
            40107199746705504466494304966262380133,
            62299304331812034354145039003976406204,
            107120668926610699674082314826705302885,
            51779832957253226887986971314240377501,
            322396792492322519803626030847860908826,
            72340263906292522461475793367197257369,
            339666889616377890736928553407270824818,
            203694605067543542789013510467394084240,
            178243066058824804355348013244028500953,
            276170685636890239816751196610149565085,
            112115533327877117584231397716542349912,
            12648796350618967052529879804094402777,
            247289788106160264183130727400795047680,
            260173788129571226449626673667505382561,
            272007032959866733955856002212359617061,
            103551808691584482345185284558074496912,
            61022184030201858367924415494974531657,
            86522777108509508640248673801195136899,
            318933320075244427182364547066763070828,
            192518069714674165749042872485792583952,
            251853380106995508734521595802246916151,
            168381027808569110409020722505337634752,
            305067398287075927724777219944369786516,
            15367067904427555413456125108005211521,
            276873999924598437824020556940362801181,
            244438417877330977927937890264620329755,
            54935201104827938399504075203514178762,
            47223971442719904056265880565346308479,
            209782723354525986921272800597047914470,
            247450816863108008189048770346317274351,
            337733814424202641533377526412935736616,
            85920496407649312068517979765621831525,
            56204751829804364845544700005382156571,
            64067286107019134177573413508179246296,
            258007449783479359375459728164957715432,
            95356764661552413808975112657018624755,
            230391013326551220182277178725693730318,
            84698366891316802108519222016877249695,
            204147455331520541353803669702582539469,
            24642718653743764165981549793263094779,
            171088509189533464703029998422944159671,
            139038518557697293222260087373603513375,
            163855392957681276521876929172495852095,
            305590203033340532037310128488250415381,
            48042047118357232992270495246145676807,
            238989902825270015733631855437625030372,
            298673493613513820847066015679469457568,
            129923625156059784224709783907476521896,
            183636336155875892662844469221780676532,
            110242309771143950947935849686286554633,
            253197658182190091591899725522778937810,
            334537541465067086903211658019651712516,
            49383261502578018738388985710375404457,
            317426005523709430290755321668123125904,
            16882487163418186840366982287889636161,
            116543259413426772862846691028145424460,
            207185903823180052364140821153943029884,
            95053977945778626635686103183487037286,
            86185975204138956938150994875944442098,
            256547669116373071155667953103051778960,
            283820875559046884924139116745529005321,
            221841563040388830307392962787612934720,
            195756801151231408977632978204894392761,
            262039879935348910357505169160934051657,
            289008251041638614082643428543713688546,
            16932612873918835683057402078863852873,
            260584801021419756724963385773524760671,
            298929346383242117885244648460692853783,
            241704250924386708454061190218109534371,
            8066283652795205980455221795968278884,
            324512671429935145074246395905158799939,
            317602998312795360541106607418076951113,
            3689344439563759647504531767468938060,
            6076611032550906462917483001954697516,
            245780342209654523127450980955577206303,
            24352318139832664643191110230900977426,
            206881262893949098092676029385132707110,
            283215996767785503404909519141208611699,
            101817288293173996081811083672397764256,
            157450784049772932764738923484639645765,
            195746673631245170476597958087627821204,
            292801601461989666690191540957408836106,
            68031819531906982118160541595243528723,
            172844546303229394108913233462927333076,
            326048358539278935582425489389783792277,
            29717082933420841425329973247956878953,
            226943769328679588312852450180142297945,
            189974526083445218172024592110970431250,
            213630451698088946285037981406032494838,
            276768164236971885533295176355394375814,
            316144355412675717750161676707283950694,
            134787738111510280739509237924390566932,
            24515866938579331774554106349228445282,
            33537778082620702181473715597568570646,
            41446417531684928546688012239020478904,
            339211330559550420085606537033480370314,
            249830222575693856918127783669147982806,
            277219659102302023087433224106616624500,
            150032916318887259361331811291434142875,
            275540576989457425769193421754811546157,
            136589615487283205633274773724607159507,
            196626736526280575262836170407866928203,
            200012841626498483556748380883080016911,
            170135743938055186650193229047405961257,
            334844079265362236695046513831721951542,
            76360701169055990429116658921252428635,
            28343824345935386617530576138201368060,
            290274631117636506210698495568680299790,
            233491875540241825942896359082151450654,
            211700599108774709344004869229973326846,
            234110468952713648336458973708792767643,
            88180754450721038123042573106918278037,
            333194208386432096046414610928638880456,
            122144099566817907767735772895898636169,
            158496047396732981535369856404604763980,
            181093611967773117034403783412053158217,
            126133781598363573833538908600250650601,
            61078456399013252822400023605092130679,
            4903443625959072123747893554539205312,
            254740395019996304314784515735829377233,
            230866583272771361713420115413968014577,
            106185057288423093514352748262299526687,
            46577739982368828307736823088955348489,
            243191554834862246552833934006274889274,
            281661909501698659809079780936344982226,
            8127424264469850645690935028192750077,
            94726293248278938626570996911218886633,
            100799996183648209124420970069981342892,
            116593603874024937494275603639585388234,
            79914180804391567303859538193830966572,
            221935616656084063920765838365222245435,
            220852731479779970890326363272344254442,
            255600470885456933965334720712630344547,
            285746131693379154467368350971063873245,
            34098114790817754801670313902297968215,
            255556410771031493238778867372536852427,
            52590055499301948145539956585014110541,
            59938678643308525135724777518717231443,
            82726710021216570408457897272004824280,
            133809287458790861664458811460910582698,
            31280558721060930715124403670851437835,
            33695259063424120510005663022917688065,
            216080175819844424366713776441228405838,
            268375159651215323650763977606911450092,
            161529187298449104287033519081991864474,
            23094297378471647354946723828376240834,
            250431839561743005841166869188038355924,
            314537984589900348626847435472940811043,
            39073148719041736225064981331693408664,
            324184320064740460655219755583177740260,
            226609149772868567297114667188237964955,
            305292390438030774614657304290291515918,
            281735807225944332479555927500158030459,
            254119352948954311370192065785211872901,
            75609600916155217001669061267635668536,
            158877932837294081720383411374221892653,
            40918910216707500398080721274835116765,
            193562402909689772926038525773079227256,
            120258703346826078624528037873778733798,
            206193354716038540600488668842300787180,
            100044594416753207523730046633944070915,
            335943190210028963870152197535575258095,
            295457956356848256412005033693768709556,
            228290858216825434725798452821240234542,
            55794743370848056686570289092527722218,
            110807699005908127813014792657283558088,
            123322314477054801520051759324877281609,
            122083252480496384468683948828086489504,
            310376703578379987729859976423414774807,
            338927036492959277022185824072574507073,
            274197076337926626659400988478509749367,
            62422695666212095176872053679137921572,
            173612401908995456223795409011293464784,
            67293157255625531921078779012182599784,
            236358661447165400862364047371294425863,
            269049547565033944217060479228815609144,
            183443717298621063585797992396716527415,
            181711387981188281924433992457956685517,
            249012176813323028935387833957682403137,
            275999521309020295684332272946500556247,
            158168659184359520785318837652810048872,
            222665311845030198125999703929306195929,
            266671205975740229198483568655991240795,
            257342917507086185698765134864397858304,
            139067141548106635799166437244022347129,
            193427651514726542938959678268172841326,
            75100253162519920264480517591950871223,
            103002416003978467450835192142331406548,
            226293223026576945057430663341478874258,
            266855213210882800584587788973337866119,
            321001196947231315161367002550204374580,
            23106589684736339409819494149781068894,
            60415478157058649878343770194292198333,
            6050096053096298870715677153569338511,
            264534224343140973858217287843938116768,
            169588104853215091749354381894197762335,
            91467644214736738606381629486558917553,
            189434568431437082014862617305642219848,
            103595602782137515621682810501337117696,
            294126971671607352356739626767375441699,
            285866527466854890447830140086180760335,
            312994140684428683056107926211958475146,
            293703229734963762998703471863245132493,
            29860725971403449123593529370870064884,
            174168857312731948328895490444365816718,
            268077209920313955939902336890215968764,
            239789353213687594274208753636440281835,
            162081859657067003656120164846190352629,
            47647205462797583633440545071885285040,
            305891750873811326445914835081635422580,
            191505508826272469374890294529130488030,
            36088742629801402212161244541845564335,
            47671649111945144135272140740781750943,
            222267978224843004888401935282157802214,
            160989252231576250321847113161831972023,
            181302329904162687023660343881609330983,
            271631804040191817775226144643301225055,
            26698521507139423828723300461133011037,
            108551472775334064140028555219989540763,
            189255813239671097450700442924695918423,
            74593482200952134171375330595627126888,
            308433376825430650871120353209564302934,
            219837125521919115232687625005918953041,
            181891700779284355103941909044465408070,
            299819578111837739212819637949962191774,
            50210449149871510834074496180845634624,
            224252653112802250077561074570807687407,
            284660367531031962550814350854180282177,
            330113361445085165757624928081935289323,
            20698547668740484919221855931514923648,
            157512443832196221083021217737675301125,
            317319537676396866667306431477934653743,
            29421445511654011709273414731153064572,
            36573224704723842098681651760600239007,
            286778117262254232693199729894029321778,
            254561136889053332771896587360367388825,
            133902094570902103474649775972373317331,
            331064252437509728480657583646435659009,
            227169794293319869441281845767875361940,
            219184822512938512957222510408750446722,
            85441664224973976058936490609831752858,
            309788570041564326891579317144494223232,
            32589234209803655563288634748202735220,
            187490277268954291388019296984832170702,
            15785170316031710935636671649627421302,
            87801865240539078390780859884182379603,
            164706368582622546576986397289248898626,
            271172007219605361414907382681127579012,
            329520031396413857451844058667735607162,
            19578764994782258370080092415749909251,
            269059497615192794226003086890985424998,
            147884949146540441983310079211499276322,
            46336556374457018164884305638834420431,
            201560492229567545722175201969409846950,
            303724992146868457907271468374408134928,
            295481715642951693665464629822691658782,
            233146867709906997190061055498764304158,
            207518878933511684003575817363789298085,
            127520367755662139817348593589550156899,
            75690151959910936882867973412313863995,
            163734499784554352414992000766966077164,
            137584941467484346169452346780271391545,
            284879206047632199876576757939667576408,
            224770023017804729764915891600581453329,
            207328295860486228192503480595039691606,
            288354493003267751539269753604556487896,
            250842152616606336701195070373764216990,
            47400036003738953629853060910533759595,
            234490976295868429878300698443089636470,
            254444594120671757739361042063918875962,
            199432048980272297282659397590190947927,
            282987675376584026881211491382686969872,
            146164838581184845257139832830205909299,
            151170672999030579871675295679148142928,
            23023448285197756706937902700590912670,
            115896399225084046544709916211262687881,
            317756611400351823669130334141017628177,
            326291935379215091120383064931868213179,
            15658978815191731084563560346797500488,
            239969792782511352109081892154833116443,
            162665626801844403879937262312349473205,
            178857252882713130620432791378307528917,
            184358881490435604064601641922179420183,
            19871787420515142997467592131160886169,
            256793946287186370027662454548201310967,
            78362995306876160343272982330485163122,
            211885147315005264492232158413508420139,
            190086363655506890053226814195290766353,
            85616038720793502324912071995132129185,
            223681628772936227243996099350967340639,
            302669484446702522369779897840282335658,
            315987919473029374935806544173332635937,
            87628297338505089122488020499886474817,
            230634751917666536317380152778892909407,
            241498853340639684808159447907365311152,
            79877010896316838071862829146947661692,
            65899376299640115496963884259648571083,
            231181523979008181726298164715652032419,
            297311202822005578875554770768774326997,
            54807797177275469346508868604579196371,
            188014874281386994076312730543047760855,
            7572291749574629394897680162857333373,
            178648204901238134064671196925441256299,
            163542427315457748923639430171982217859,
            153816714330094396851294923785863308479,
            111814208593380495907691689975871744281,
            73142210079408461229888004182206810506,
            35902100248383444968325792286991696229,
            287588811851252721056212278096925537221,
            189267720193425297956382741204764998029,
            158111593782895259018112267649328842283,
            178592588089104222436075411477212336873,
            228553716362070717534147396988596496104,
            297924371572761892859635906866070410431,
            296498451702559934678917007032476198178,
            129621609716690016157350158004427160080,
            271535602136526858319385957788743639575,
            194900976784301416017794759087987436697,
            298056366202479656309538290590581137378,
            154404692265452587345109097299281726894,
            191113678045310453566662344169095982570,
            17418625688026079887793679303997988351,
            36357698338134549353741264035052377243,
            283805207221172526279225113210906662787,
            215972798900234406739529319416751902760,
            259422021555070306195799477291938358268,
            300623240136210018474176251079836245040,
            274696189441611231493671869733143625168,
            227287560496677502033808802849428918693,
            331751180281654669827362401401737449550,
            92412615514019086886122796941379869309,
            333059387654936255669226686721000917741,
            288056081259848432187096652254932556822,
            227668193922357163724931754283920678793,
            139132747549160981947817086485609636399,
            318609225308716324030407952567796024185,
            134713864121679466591798110838727361531,
            105860310081170000962235985561884286719,
            329576545561041128899641862033572946518,
            165508016402385021798382428877834462763,
            132470795889528328927203979000735842157,
            67049644830084973242747981472166874285,
            307270619667644525113456449313106937747,
            156290508509347860270413117626107149787,
            305360367187871497306061445691614437502,
            317554288361319225796096780007933161695,
            5076901514503321762832721252921533153,
            114831221115840423353801923014700945250,
            141146177665025048842753365445831713316,
            141451158953208785167502574169864217671,
            139699971297931616328799316789595414861,
            30528737062272359770682590624425424916,
            326038287715865554319680045735661099830,
            294390240357334792691846168645903642172,
            105316568056971946530375753683572556395,
            75012321163034295553561781321894403468,
            54060005543703571052977133408112832782,
            123312249189770327167539036922995487064,
            108341663482827153015137895288673306485,
            183813114561894474512618398653836345105,
            96908884689307567009176793015139248376,
            285741471533410062670285071674183396235,
            184580264361661278150049607451034242300,
            298794261082628234561885722590411012111,
            129649675761773697351486888322507999358,
            89317873967304270030038801306741000372,
            209705495205897777908039942765743846783,
            323548032092204053102940567178364260854,
            336329786428851606492011668309242185052,
            94450954501880879012732088151876176784,
            263350033663535627309615338765762722992,
            74231005521089458024011180387391106223,
            196993557777052737323491228289411672322,
            185432116971706223601731814654165933694,
            244280951902172093767833034263246703757,
            322905424506624829034636006888062554022,
            24621435918980614521900101508905588487,
            11889453936197915883313294843953868113,
            246468270639729060221832748323075180460,
            261969096628997279696500194835770883910,
            110189359468427205640880243509372528354,
            298370371756247643754986847140359762756,
            73786674990830211761797808759125981440,
            278220964730288205392998241464951429807,
            145927693791676903572605982446541768758,
            238913463517096548899166008473946211000,
            122504249082245788272559502622918530499,
            200699893555194663969291200967548579195,
            135789517706778343732919209342377932234,
            47258455460510037831821506113078271509,
            238634861811586582402665770606170925783,
            105086073428407165053374573306905781750,
            125439646034611534466580252649067388277,
            256175030259548771740550876426911366194,
            180981408807208369393605517504730132825,
            272174639480242306929495546346652252717,
            217237049653102075375614443393860401826,
            116177007233412728298075877616408161033,
            282020635559367536586221321840183205664,
            322579440793057832931744475644191017992,
            253706184676862535086545304569008455509,
            241699404405221999943408758353788744686,
            140593428907055554652175980017383788879,
            296440732383174571917927203060306520259,
            316776556601069061330417620996821762045,
            176712958595240324542442051334426015719,
            2149058315451240240975349986795484745,
            3699090996756227872286381469887546782,
            8835929303075431796700819504387998048,
            192091875565068576555773576850034526753,
            90811841977782968668311691127211478030,
            249286762200862626309261358196365356225,
            198617841635280861808850749842516227343,
            83834665644088707168764414368395960382,
            122905758229451161770057463790260324573,
            183408799755750320676967699769521631541,
            49640520644089804524881912726586812745,
            204823241461666078124788766102563858575,
            166481927150114920071718549493037548275,
            237666403696592302960315621671282389869,
            269831507998323310181288032981360639123,
            335393044892119746803622206539295266263,
            323240063879736941882167611629141908761,
            275513108544732715356819120165419584872,
            37733494652649353162675340723497761464,
            89811263341254381125745149369528626502,
            298287850135988604282387567154403153731,
            167231802096295590755726580196206392765,
            99863890856138932557463596795485645107,
            285390003090372119616048995546900318994,
            267525189551874383713333173687767635599,
            68657017721343790862819938006537900457,
            90635714261568669053807761306211808026,
            38507744935135275393456092042120754472,
            1623050361812811569870505350230304391,
            48541273083223163259355125300136636482,
            234623138194090706595293141499297163893,
            228518184721852122184462670110198039965,
            8597474495728491049785022388606513518,
            304607245199833349920581340210926351490,
            80711995531856778300886494914759417243,
            332223201161321642009263420525274295807,
            304817912120348331754084362559278777049,
            82796611664836870296838816198960056860,
            265458050267340798999198849257575001567,
            47624712368302670489035873496801660034,
            26149792086423961110516810241243176886,
            318530650514310957537271497674042030581,
            85345730605197135728954099120994370254,
            67378141894261895848065324951945015999,
            171340471357423037025889777588789632464,
            223624315494596511011300304585523793396,
            60262181144760052894312988611095851564,
            55221218330314373120931032300282231416,
            182155671237968883672774134518549316793,
            170619249651601377254149391008942080723,
            25462149310120470636329042734819579563,
            93597639684669332165258072301877852520,
            102056102658945334461416898161558754837,
            280386195700612975450262539102901102799,
            191871421878962975132851130334239548478,
            315808637744007693200101172251378725891];

    var RC0;
    var RC1;
    var RC2; 
    var RC3; 

    var nRounds = 134;

    component perm[nRounds];
    
    for (var i=0; i<nRounds; i++) {

        perm[i] = Permutation();

        RC0 = c[4*i];
        RC1 = c[4*i + 1];
        RC2 = c[4*i + 2];
        RC3 = c[4*i + 3];

        perm[i].RC0 <== RC0;
        perm[i].RC1 <== RC1;
        perm[i].RC2 <== RC2;
        perm[i].RC3 <== RC3;

        if (i == 0) {
            perm[i].a0 <== a0;
            perm[i].b0 <== b0;
            perm[i].c0 <== c0;
        } else {
            perm[i].a0 <== perm[i-1].a1;
            perm[i].b0 <== perm[i-1].b1;
            perm[i].c0 <== perm[i-1].c1;
       }
    
    }
    
    a1 <== perm[nRounds - 1].a1;
    b1 <== perm[nRounds - 1].b1;
    c1 <== perm[nRounds - 1].c1;

}


template IteratedPermutationR() {
    signal input a0;
    signal input b0;
    signal input c0;
    
    signal output a1;
    signal output b1;
    signal output c1;
   
    var c[40] = [
        323240063879736941882167611629141908761,
        275513108544732715356819120165419584872,
        37733494652649353162675340723497761464,
        89811263341254381125745149369528626502,
        298287850135988604282387567154403153731,
        167231802096295590755726580196206392765,
        99863890856138932557463596795485645107,
        285390003090372119616048995546900318994,
        267525189551874383713333173687767635599,
        68657017721343790862819938006537900457,
        90635714261568669053807761306211808026,
        38507744935135275393456092042120754472,
        1623050361812811569870505350230304391,
        48541273083223163259355125300136636482,
        234623138194090706595293141499297163893,
        228518184721852122184462670110198039965,
        8597474495728491049785022388606513518,
        304607245199833349920581340210926351490,
        80711995531856778300886494914759417243,
        332223201161321642009263420525274295807,
        304817912120348331754084362559278777049,
        82796611664836870296838816198960056860,
        265458050267340798999198849257575001567,
        47624712368302670489035873496801660034,
        26149792086423961110516810241243176886,
        318530650514310957537271497674042030581,
        85345730605197135728954099120994370254,
        67378141894261895848065324951945015999,
        171340471357423037025889777588789632464,
        223624315494596511011300304585523793396,
        60262181144760052894312988611095851564,
        55221218330314373120931032300282231416,
        182155671237968883672774134518549316793,
        170619249651601377254149391008942080723,
        25462149310120470636329042734819579563,
        93597639684669332165258072301877852520,
        102056102658945334461416898161558754837,
        280386195700612975450262539102901102799,
        191871421878962975132851130334239548478,
        315808637744007693200101172251378725891
    ];

    var RC0;
    var RC1;
    var RC2; 
    var RC3; 

    var nRounds = 10;

    component perm[nRounds];
    
    for (var i=0; i<nRounds; i++) {

        perm[i] = Permutation();

        RC0 = c[4*i];
        RC1 = c[4*i + 1];
        RC2 = c[4*i + 2];
        RC3 = c[4*i + 3];

        perm[i].RC0 <== RC0;
        perm[i].RC1 <== RC1;
        perm[i].RC2 <== RC2;
        perm[i].RC3 <== RC3;

        if (i == 0) {
            perm[i].a0 <== a0;
            perm[i].b0 <== b0;
            perm[i].c0 <== c0;
        } else {
            perm[i].a0 <== perm[i-1].a1;
            perm[i].b0 <== perm[i-1].b1;
            perm[i].c0 <== perm[i-1].c1;
       }
    
    }
    
    a1 <== perm[nRounds - 1].a1;
    b1 <== perm[nRounds - 1].b1;
    c1 <== perm[nRounds - 1].c1;

}

